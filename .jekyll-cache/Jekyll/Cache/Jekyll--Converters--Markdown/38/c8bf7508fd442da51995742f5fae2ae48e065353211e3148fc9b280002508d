I"èY<h2 id="hbase">HBase</h2>

<ol>
  <li><a href="#hBaseç®€ä»‹">HBaseç®€ä»‹</a></li>
  <li><a href="#hbaseå®‰è£…">HBaseå®‰è£…</a></li>
  <li><a href="#hbaseè¯»å†™æµç¨‹">HBaseè¯»å†™æµç¨‹</a></li>
  <li><a href="#hbaseå®æˆ˜ä½¿ç”¨">HBaseå®æˆ˜ä½¿ç”¨</a></li>
</ol>

<h4 id="hbaseç®€ä»‹">HBaseç®€ä»‹</h4>

<blockquote>
  <p>é¢å‘åˆ—ã€é€‚åˆéç»“æ„åŒ–æ•°æ®å­˜å‚¨</p>
</blockquote>

<p>HBaseæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€é¢å‘åˆ—çš„å¼€æºæ•°æ®åº“ï¼Œè¯¥æŠ€æœ¯æ¥æºäº Fay Chang æ‰€æ’°å†™çš„Googleè®ºæ–‡â€œBigtableï¼šä¸€ä¸ªç»“æ„åŒ–æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿâ€ã€‚å°±åƒBigtableåˆ©ç”¨äº†Googleæ–‡ä»¶ç³»ç»Ÿï¼ˆFile Systemï¼‰æ‰€æä¾›çš„åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ä¸€æ ·ï¼ŒHBaseåœ¨Hadoopä¹‹ä¸Šæä¾›äº†ç±»ä¼¼äºBigtableçš„èƒ½åŠ›ã€‚HBaseæ˜¯Apacheçš„Hadoopé¡¹ç›®çš„å­é¡¹ç›®ã€‚HBaseä¸åŒäºä¸€èˆ¬çš„å…³ç³»æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€‚åˆäºéç»“æ„åŒ–æ•°æ®å­˜å‚¨çš„æ•°æ®åº“ã€‚å¦ä¸€ä¸ªä¸åŒçš„æ˜¯HBaseåŸºäºåˆ—çš„è€Œä¸æ˜¯åŸºäºè¡Œçš„æ¨¡å¼</p>

<h5 id="åœ¨ç”Ÿæ€åœˆæ‰€å¤„åœ°ä½">åœ¨ç”Ÿæ€åœˆæ‰€å¤„åœ°ä½:</h5>

<ul>
  <li>HBaseæ˜¯ApacheåŸºé‡‘ä¼šé¡¶çº§é¡¹ç›®</li>
  <li>HBaseåŸºäºHadoopçš„æ ¸å¿ƒHDFSç³»ç»Ÿè¿›è¡Œæ•°æ®å­˜å‚¨</li>
  <li>HBaseå¯ä»¥å­˜å‚¨è¶…å¤§æ•°æ®å¹¶ä½¿ç”¨ç”¨æ¥è¿›è¡Œå¤§æ•°æ®çš„==å®æ—¶æŸ¥è¯¢==</li>
</ul>

<h5 id="hbase--hdfs">HBase &amp; HDFS</h5>

<ul>
  <li>HBaseå»ºç«‹åœ¨Hadoopæ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Š,åˆ©ç”¨äº†Hadoopæ–‡ä»¶ç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›</li>
  <li>HBaseæä¾›å¯¹æ•°æ®çš„éšæœºå®æ—¶è¯»å†™/è®¿é—®çš„èƒ½åŠ›</li>
  <li>HBaseå†…éƒ¨ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œå¹¶å­˜å‚¨ç´¢å¼•ï¼Œå¯å°†HDFSæ–‡ä»¶ä¸­æ•°æ®è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾</li>
</ul>

<h5 id="hbase--å¸¸ç”¨å…³ç³»å‹æ•°æ®åº“">HBase &amp; å¸¸ç”¨å…³ç³»å‹æ•°æ®åº“</h5>

<blockquote>
  <p>äº‹ç‰©æ”¯æŒ åªæ”¯æŒå•ä¸ªRowçº§åˆ«ï¼Œç´¢å¼•åªæ”¯æŒRow-key</p>
</blockquote>

<ul>
  <li>NameSpace: å¯ä»¥æŠŠNameSpaceç†è§£ä¸ºRDBMSçš„æ•°æ®åº“</li>
  <li>Table: è¡¨åå¿…é¡»æ˜¯èƒ½ç”¨åœ¨æ–‡ä»¶è·¯å¾„é‡Œçš„åˆæ³•åå­—</li>
  <li>Row: åœ¨è¡¨é‡Œé¢ï¼Œæ¯ä¸€è¡Œä»£è¡¨ç€ä¸€ä¸ªæ•°æ®å¯¹è±¡ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä»¥ä¸€ä¸ªè¡Œé”®(Row Key)æ¥è¿›è¡Œå”¯ä¸€æ ‡è¯†çš„ï¼Œè¡Œé”®å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œä»¥äºŒè¿›åˆ¶çš„å­—èŠ‚æ¥å­˜å‚¨</li>
  <li>Column: HBaseçš„åˆ—ç”±Column familyå’ŒColumn qualifierç»„æˆï¼Œç”±å†’å·(:)è¿›è¡Œé—´éš”ã€‚æ¯”å¦‚famiy:qualifier</li>
  <li>RowKey: å¯ä»¥å”¯ä¸€æ ‡è¯†ä¸€è¡Œè®°å½•ï¼Œä¸å¯è¢«æ”¹å˜</li>
  <li>Column Family: åœ¨å®šä¹‰HBaseè¡¨çš„æ—¶å€™éœ€è¦æå‰è®¾ç½®å¥½åˆ—æ—ï¼Œè¡¨ä¸­æ‰€æœ‰åˆ—éƒ½éœ€è¦ç»„ç»‡åœ¨åˆ—æ—é‡Œé¢</li>
  <li>Column Qualifier: åˆ—æ—ä¸­çš„æ•°æ®é€šè¿‡åˆ—æ ‡è¯†æ¥è¿›è¡Œæ˜ å°„ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé”®å€¼å¯¹ï¼ŒColumn Qualifierå°±æ˜¯key</li>
  <li>Cell: æ¯ä¸€ä¸ªè¡Œé”®ï¼Œåˆ—æ—å’Œåˆ—æ ‡è¯†å…±åŒç»„æˆä¸€ä¸ªå•å…ƒ</li>
  <li>Timestamp: æ¯ä¸€ä¸ªå€¼éƒ½ä¼šæœ‰ä¸€ä¸ªtimestampï¼Œä½œä¸ºè¯¥å€¼ç‰¹å®šç‰ˆæœ¬çš„æ ‡è¯†ç¬¦ï¼Œç”±HBaseç®¡ç†,é»˜è®¤ä¿å­˜3ä¸ªä¿æœ¬</li>
</ul>

<p>å…³ç³»å‹æ•°æ®åº“å­˜å‚¨æ–¹å¼:</p>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>File Name</th>
      <th>File Size</th>
      <th>creator</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>a.txt</td>
      <td>20</td>
      <td>å¼ ä¸‰</td>
    </tr>
    <tr>
      <td>2</td>
      <td>b.txt</td>
      <td>30</td>
      <td>æå››</td>
    </tr>
  </tbody>
</table>

<p>HBaseå­˜å‚¨:</p>

<p>å°†File Nameå’ŒFile SizeæŠ½è±¡æˆä¸€ä¸ªåˆ—æ—,å°†creatoræŠ½è±¡æˆä¸€ä¸ªåˆ—æ—</p>

<table>
  <thead>
    <tr>
      <th>RowKey</th>
      <th>FileInfo</th>
      <th>SaveInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>name:a.txt size:20</td>
      <td>creator:å¼ ä¸‰</td>
    </tr>
    <tr>
      <td>2</td>
      <td>name:b.txt size:30</td>
      <td>creator:æå››</td>
    </tr>
  </tbody>
</table>

<h5 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h5>

<ul>
  <li>ç¬é—´å†™å…¥é‡å¾ˆå¤§,å¸¸ç”¨æ•°æ®ä¸å¥½æ”¯æ’‘æˆ–éœ€è¦å¾ˆé«˜æˆæœ¬</li>
  <li>æ•°æ®éœ€è¦é•¿ä¹…ä¿å­˜ï¼Œä¸”é‡ä¼šæŒä¹…å¢é•¿åˆ°æ¯”è¾ƒå¤§çš„åœºæ™¯</li>
  <li>HBaseä¸é€‚ç”¨äºæœ‰joinï¼Œå¤šçº§ç´¢å¼•ï¼Œè¡¨å…³ç³»å¤åˆ¶çš„æ•°æ®æ¨¡å‹</li>
</ul>

<h3 id="hbaseå®‰è£…">HBaseå®‰è£…</h3>

<ol>
  <li>ä¸‹è½½å¯¹åº”å®‰è£…åŒ…,æ‰¾åˆ°å¯¹åº”Hadoopç‰ˆæœ¬ä¸‹è½½,å¹¶è§£å‹</li>
  <li>å¤åˆ¶ Hadoopå†… core.site.xmlå’Œhdfs-site.xmlæ–‡ä»¶åˆ°HBaseçš„confç›®å½•å†…</li>
  <li>ä¿®æ”¹hbase-env.sh
    <ol>
      <li>export JAVA_HOME=/home/hadoop/app/jdk8</li>
      <li>æ‰¾åˆ°  Configure PermSize. Only needed in JDK7 â€¦ æ³¨é‡Šæ‰ä¸‹é¢çš„ä¸¤è¡Œ(HBASE_MASTER_OPTS ã€HBASE_REGIONSERVER_OPTS)</li>
    </ol>
  </li>
  <li>ä¿®æ”¹ hbase-site.xml</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;hbase.rootdir&lt;/name&gt;
        # å’Œhadoopå¯åŠ¨çš„ç«¯å£ä¸€è‡´
        &lt;value&gt;hdfs://hadoop000:8020/hbase&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        # æ–°å»ºå­˜å‚¨ç›®å½•
        &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;
        &lt;value&gt;/home/hadoop/app/hbasetmp&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<h3 id="hbaseè¯»å†™æµç¨‹">HBASEè¯»å†™æµç¨‹</h3>

<h4 id="hbase-å†™æµç¨‹">HBASE å†™æµç¨‹</h4>

<ul>
  <li>Clientä¼šå…ˆè®¿é—®zookeeper,å¾—åˆ°å¯¹åº”çš„RegionServeråœ°å€</li>
  <li>Clientå¯¹RegionServerå‘èµ·å†™è¯·æ±‚ï¼ŒRegionServeræ¥å—æ•°æ®å†™å…¥å†…å­˜</li>
  <li>å½“MemStroreçš„å¤§å°è¾¾åˆ°ä¸€å®šçš„å€¼å,flushåˆ°StoreFileå¹¶å­˜å‚¨åˆ°HDFS</li>
</ul>

<p>åæ¬¡é‡Šæ„:</p>

<ol>
  <li>RegionServer : ç®¡ç†å¤šä¸ª Region, æ¯ä¸€ä¸ªRegionServerå¯¹åº”ä¸€ä¸ªHLog</li>
  <li>Region : åŒ…å«å¤šä¸ªStore,æ¯ä¸€ä¸ªStore åŒ…å« MemStore å’Œ StoreFileï¼Œå†™å…¥æ•°æ®çš„æ—¶å€™,å…ˆå†™å…¥åˆ°MemStoreä¸­ï¼Œå½“MemStoreæ»¡äº†,
å†å†™å…¥åˆ° StoreFile</li>
  <li>StoreFile : å¯¹åº”HDFSä¸­çš„HFile,æ˜¯å…¶ä¸€å±‚å°è£…</li>
  <li>WAL : Write-Ahead Logging, é¢„å†™æ—¥å¿—ç³»ç»Ÿ
æ•°æ®åº“ä¸­ä¸€ç§é«˜æ•ˆçš„æ—¥å¿—ç®—æ³•ï¼Œå¯¹äºéå†…å­˜æ•°æ®åº“è€Œè¨€ï¼Œç£ç›˜I/Oæ“ä½œæ˜¯æ•°æ®åº“æ•ˆç‡çš„ä¸€å¤§ç“¶é¢ˆã€‚åœ¨ç›¸åŒçš„æ•°æ®é‡ä¸‹ï¼Œé‡‡ç”¨WALæ—¥å¿—çš„æ•°æ®åº“ç³»ç»Ÿåœ¨äº‹åŠ¡æäº¤æ—¶ï¼Œç£ç›˜å†™æ“ä½œåªæœ‰ä¼ ç»Ÿçš„å›æ»šæ—¥å¿—çš„ä¸€åŠå·¦å³ï¼Œå¤§å¤§æé«˜äº†æ•°æ®åº“ç£ç›˜I/Oæ“ä½œçš„æ•ˆç‡ï¼Œä»è€Œæé«˜äº†æ•°æ®åº“çš„æ€§èƒ½ã€‚
ä¸€èˆ¬çš„WALçš„å®ç°æ–¹å¼æ˜¯å…ˆå†™å…¥æ—¥å¿—,å†å†™å…¥å†…å­˜,HBaseæ˜¯å…ˆå†™å…¥å†…å­˜,å†å†™åˆ°HLogä¸­(æ›´æ–°æ“ä½œ)</li>
  <li>HLog : WALçš„ä¸€ç§å®ç°æ–¹å¼,åªæœ‰å½“HLogæ›´æ–°äº†,æ‰è¡¨ç¤ºæ­¤æ¡æ•°æ®å†™å…¥æˆåŠŸã€‚</li>
</ol>

<h4 id="hbase-è¯»æµç¨‹">HBASE è¯»æµç¨‹</h4>

<ul>
  <li>Clientä¼šå…ˆè®¿é—®zookeeper,å¾—åˆ°å¯¹åº”çš„RegionServeråœ°å€,æ‹‰å»metaä¿¡æ¯è¡¨</li>
  <li>Clientå¯¹RegionServerå‘èµ·è¯»è¯·æ±‚ï¼ŒRegionServeræ ¹æ®metaä¿¡æ¯å¼€å§‹è¯»å–æ•°æ®</li>
  <li>æ‰«æmemStore â€“&gt; æ‰«æblockcache â€“ &gt; ä»storefileä¸­è¯»å–æ•°æ®</li>
</ul>

<h4 id="ä¸‰ä¸ªé—®é¢˜">ä¸‰ä¸ªé—®é¢˜</h4>

<ol>
  <li>HBaseå¯åŠ¨æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ
    <ol>
      <li>HMasterå¯åŠ¨,æ³¨å†ŒZookeeper,ç­‰å¾…RegionServeræ±‡æŠ¥</li>
      <li>RegionServeræ³¨å†Œåˆ°Zokeeper,å¹¶å‘HMasteræ±‡æŠ¥</li>
      <li>å¯¹å„ä¸ªRegionServer(åŒ…æ‹¬å¤±æ•ˆçš„)çš„æ•°æ®è¿›è¡Œæ•°æ®æ•´ç†,åˆ†é…Regionå’Œmetaä¿¡æ¯</li>
      <li>å…¶ä»–backupMasterå®šæœŸå‘activeMasterè¿›è¡Œæ›´æ–°ï¼Œä¿è¯metaçš„æœ€æ–°</li>
    </ol>
  </li>
  <li>å½“RegionServerå¤±æ•ˆåä¼šå‘ç”Ÿä»€ä¹ˆ
    <ol>
      <li>HMasterå°†å¤±æ•ˆçš„RegionServerä¸Šçš„Regionåˆ†é…åˆ°å…¶ä»–èŠ‚ç‚¹</li>
      <li>HMasteræ›´æ–° hbase:meta è¡¨ä»¥ä¿è¯æ•°æ®æ­£å¸¸è®¿é—®</li>
    </ol>
  </li>
  <li>å½“HMasterå¤±æ•ˆåä¼šå‘ç”Ÿä»€ä¹ˆ
    <ol>
      <li>å¤„äºBackupçŠ¶æ€çš„HMasterèŠ‚ç‚¹æ¨é€‰å‡ºä¸€ä¸ªè½¬ä¸ºActiveçŠ¶æ€</li>
      <li>(è‹¥æ²¡æœ‰é…ç½®é«˜å¯ç”¨,activemasterå¤±æ•ˆå)æ•°æ®èƒ½æ­£å¸¸è¯»å†™,ä½†æ˜¯ä¸èƒ½åˆ›å»ºåˆ é™¤è¡¨,ä¹Ÿä¸èƒ½æ›´æ”¹è¡¨ç»“æ„</li>
    </ol>
  </li>
</ol>

<h3 id="hbaseå®æˆ˜ä½¿ç”¨">HBaseå®æˆ˜ä½¿ç”¨</h3>

<h4 id="shellæ“ä½œå‘½ä»¤">SHELLæ“ä½œå‘½ä»¤</h4>

<table>
  <thead>
    <tr>
      <th>åç§°</th>
      <th>å‘½ä»¤è¡¨è¾¾å¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>æŸ¥çœ‹å­˜åœ¨å“ªäº›è¡¨</td>
      <td>list</td>
    </tr>
    <tr>
      <td>åˆ›å»ºè¡¨</td>
      <td>create â€˜è¡¨åç§°â€™,â€™åˆ—åç§°1â€™,â€™åˆ—åç§°2â€™,â€™åˆ—åç§°Nâ€™</td>
    </tr>
    <tr>
      <td>æ·»åŠ è®°å½•</td>
      <td>put â€˜è¡¨åç§°â€™,â€™è¡Œåç§°â€™,â€™åˆ—åç§°â€™,â€™å€¼â€™</td>
    </tr>
    <tr>
      <td>æŸ¥çœ‹è®°å½•</td>
      <td>get â€˜è¡¨åç§°â€™,â€™è¡Œåç§°â€™</td>
    </tr>
    <tr>
      <td>æŸ¥çœ‹è¡¨ä¸­çš„è®°å½•æ€»æ•°</td>
      <td>count â€˜è¡¨åç§°â€™</td>
    </tr>
    <tr>
      <td>åˆ é™¤è®°å½•</td>
      <td>delete â€˜è¡¨åâ€™,â€™è¡Œåç§°â€™,â€™åˆ—åç§°â€™</td>
    </tr>
    <tr>
      <td>åˆ é™¤ä¸€å¼ è¡¨</td>
      <td>å…ˆè¦å±è”½è¯¥è¡¨,æ‰èƒ½å¯¹è¯¥è¡¨è¿›è¡Œåˆ é™¤,ç¬¬ä¸€æ­¥ disable â€˜è¡¨åç§°â€™ ç¬¬äºŒæ­¥ drop â€˜è¡¨åç§°â€™</td>
    </tr>
    <tr>
      <td>æŸ¥çœ‹æ‰€æœ‰è®°å½•</td>
      <td>scan â€˜è¡¨åç§°â€™</td>
    </tr>
    <tr>
      <td>æŸ¥çœ‹æŸä¸ªè¡¨æŸä¸ªåˆ—ä¸­çš„æ‰€æœ‰æ•°æ®</td>
      <td>scan â€˜è¡¨åç§°â€™,[â€˜åˆ—åç§°:â€™]</td>
    </tr>
    <tr>
      <td>æ›´æ–°è®°å½•</td>
      <td>å°±æ˜¯é‡å†™ä¸€è¾¹è¿›è¡Œè¦†ç›–</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¿›å…¥Hbaseå‘½ä»¤è¡Œæ“ä½œ ï¼š $HBASE_HOME/bin/hbase.sh shell

æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ ï¼š status

æŸ¥çœ‹æ‰€æœ‰çš„è¡¨ : list

åˆ›å»ºä¸€å¼ è¡¨å¹¶åˆ¶å®šåˆ—æ— : create 'FileTable','saveInfo','tableInfo'

æ·»åŠ ä¸€ä¸ªåˆ—æ— : alter 'FileTable','cf'

åˆ é™¤ä¸€ä¸ªåˆ—æ— : alter 'Filetable',{NAME=&gt;'cf',METHOD=&gt;'delete'}

æ·»åŠ æ•°æ® : put 'FileTable','rowkey1','fileInfo:size','10241'

æŸ¥çœ‹è¡¨æ•°æ® : get 'FileTable','rowkey1'
    æŸ¥çœ‹æŒ‡å®šåˆ—æ— : get 'FileTable','rowkey1','fileInfo'

æŸ¥çœ‹æ‰€æœ‰æ•°æ® : scan 'FileTable'
    æŸ¥çœ‹æŒ‡å®šåˆ— : scan 'FileTable',{COLUMN=&gt;'fileinfo'}
    æŸ¥çœ‹ ä» rowkey1å¼€å§‹ï¼Œè¿”å›2æ¡æ•°æ®,ç‰ˆæœ¬æ˜¯æœ€è¡Œçš„
    scan 'FileTable',{STARTROW=&gt;'rokey1',LIMIT=&gt;2,VERSIONS=&gt;1}

åˆ é™¤åˆ—ä¸­æŸä¸€ä¸ªå€¼ : delete 'FileTable','rowkey1','fileInfo:size'
åˆ é™¤æ•´ä¸ªåˆ— : delteall 'FileTable','rowkey1'

åˆ é™¤æ•´ä¸ªè¡¨ :
    1. disable 'FileTable'
    2. drop 'FileTable'

æŸ¥çœ‹è¡¨çŠ¶æ€ is_dsiabled 'FileTable'
æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ exists 'FileTable'
</code></pre></div></div>

<h4 id="hbase-java-api">HBase JAVA API</h4>

<h5 id="å¼€å‘hbaseæ•°æ®åº“æ“ä½œç±»">å¼€å‘HBaseæ•°æ®åº“æ“ä½œç±»</h5>

<h6 id="è¿‡æ»¤å™¨">è¿‡æ»¤å™¨</h6>

<p>HBaseä¸ºç­›é€‰æ•°æ®æä¾›äº†ä¸€ç»„è¿‡æ»¤å™¨,é€šè¿‡è¿‡æ»¤å™¨å¯ä»¥åœ¨æ•°æ®çš„
å¤šä¸ªçº¬åº¦ä¸Šè¿›è¡Œæ•°æ®çš„ç­›é€‰(è¡Œã€åˆ—ã€æ•°æ®ç‰ˆæœ¬),é€šå¸¸æ¥è¯´å¯¹è¡Œ
åˆ—è¿›è¡Œç­›é€‰çš„åº”ç”¨åœºæ™¯è¾ƒå¤š</p>

<ol>
  <li>åŸºäºè¡Œçš„è¿‡æ»¤å™¨
    <ol>
      <li>PrefixFilter: è¡Œçš„å‰ç¼€åŒ¹é…</li>
      <li>PageFilter: åŸºäºè¡Œçš„åˆ†é¡µ</li>
    </ol>
  </li>
  <li>åŸºäºåˆ—çš„è¿‡æ»¤å™¨
    <ol>
      <li>ColumnPrefixFilter: åˆ—å‰ç¼€åŒ¹é…</li>
      <li>FirstKeyOnlyFilter: åªè¿”å›æ¯ä¸€è¡Œçš„ç¬¬ä¸€åˆ—</li>
    </ol>
  </li>
  <li>åŸºäºå•å…ƒå€¼çš„è¿‡æ»¤å™¨
    <ol>
      <li>KeyOnlyFilter: è¿”å›çš„æ•°æ®ä¸åŒ…æ‹¬å•å…ƒå€¼,åªåŒ…å«è¡Œé”®ä¸åˆ—</li>
      <li>TimestampsFilter: æ ¹æ®æ•°æ®çš„æ—¶é—´æˆ³ç‰ˆæœ¬è¿›è¡Œè¿‡æ»¤</li>
    </ol>
  </li>
  <li>åŸºäºåˆ—å’Œå•å…ƒå€¼çš„è¿‡æ»¤å™¨
    <ol>
      <li>SingleColumnValueFilter : å¯¹è¯¥åˆ—çš„å•å…ƒå€¼è¿›è¡Œæ¯”è¾ƒè¿‡æ»¤</li>
      <li>SingleColumnValueExcludeFilter: å¯¹è¯¥åˆ—çš„å•å…ƒå€¼è¿›è¡Œæ¯”è¾ƒè¿‡æ»¤</li>
    </ol>
  </li>
  <li>æ¯”è¾ƒè¿‡æ»¤å™¨
    <ol>
      <li>æ¯”è¾ƒè¿‡æ»¤å™¨é€šå¸¸éœ€è¦ä¸€ä¸ªæ¯”è¾ƒè¿ç®—ç¬¦ä»¥åŠä¸€ä¸ªæ¯”è¾ƒå™¨æ¥å®ç°è¿‡æ»¤</li>
      <li>RowFilterã€FamilyFilterã€QualifierFilterã€ValueFilter</li>
    </ol>
  </li>
  <li>è‡ªå®šä¹‰è¿‡æ»¤å™¨
    <ol>
      <li>å®ç°FilterBaseç±» å®ç°ç›¸åº”æ–¹æ³•</li>
    </ol>
  </li>
</ol>

<h5 id="ç®€å•ä½¿ç”¨">ç®€å•ä½¿ç”¨</h5>

<h6 id="å¼•å…¥åŒ…">å¼•å…¥åŒ…</h6>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hbase&lt;/groupId&gt;
            &lt;artifactId&gt;hbase-client&lt;/artifactId&gt;
            &lt;version&gt;1.2.4&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
&lt;/dependencies&gt;

</code></pre></div></div>

<h6 id="è·å–æ•°æ®åº“è¿æ¥">è·å–æ•°æ®åº“è¿æ¥</h6>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.Connection;
import org.apache.hadoop.hbase.client.ConnectionFactory;
import org.apache.hadoop.hbase.client.Table;

import java.io.IOException;

public class HBaseConn {

    private static final HBaseConn INSTANCE = new HBaseConn();

    private static Configuration configuration;

    private static Connection connection;

    private HBaseConn(){
        try {
            if (configuration == null){
                configuration = HBaseConfiguration.create();
                // zookeeper åœ°å€åŠç«¯å£
                configuration.set("hbase.zookeeper.quorum","172.16.54.134:2181");
            }
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    // è·å–è¿æ¥
    private Connection getConnection(){
        if (connection == null || connection.isClosed()){
            try {
                // è®¾ç½®è¿æ¥é…ç½®
                connection = ConnectionFactory.createConnection(configuration);
            }catch (Exception e){
                e.printStackTrace();
            }
        }

        return connection;
    }

    // è·å–è¿æ¥
    public static  Connection getHBaseConn(){
        return INSTANCE.getConnection();
    }

    // è·å–è¡¨
    public static Table getTable(String tableName) throws IOException {
        return INSTANCE.getConnection().getTable(TableName.valueOf(tableName));
    }

    // å…³é—­è¿æ¥
    public static void closeConn(){
        if (connection != null){
            try {
                connection.close();
            }catch (IOException e){
                e.printStackTrace();
            }
        }
    }
}

</code></pre></div></div>

<h6 id="åˆ›å»ºç›¸åº”æ–¹æ³•">åˆ›å»ºç›¸åº”æ–¹æ³•</h6>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.apache.hadoop.hbase.HColumnDescriptor;
import org.apache.hadoop.hbase.HTableDescriptor;
import org.apache.hadoop.hbase.TableName;
import org.apache.hadoop.hbase.client.*;
import org.apache.hadoop.hbase.filter.FilterList;
import org.apache.hadoop.hbase.util.Bytes;

import java.io.IOException;
import java.util.Arrays;
import java.util.List;

public class HBaseUtil {

    /**
     * @description:
     * @date: 2019/07/17
     * @param: [tableName, cfs]
     * è¡¨å åˆ—æ—çš„æ•°ç»„
     * @return: boolean
     */
    public static boolean createTable(String tableName,String[] cfs){

        try (HBaseAdmin admin= (HBaseAdmin)HBaseConn.getHBaseConn().getAdmin()) {
            if (admin.tableExists(tableName)){
                return false;
            }
            HTableDescriptor tableDescriptor = new HTableDescriptor(TableName.valueOf(tableName));

            Arrays.stream(cfs).forEach( cf -&gt; {
                HColumnDescriptor columnDescriptor = new HColumnDescriptor(cf);
                columnDescriptor.setMaxVersions(1);
                tableDescriptor.addFamily(columnDescriptor);
            });

            admin.createTable(tableDescriptor);
        }catch (Exception e){
            e.printStackTrace();
        }
        return true;
    }

    public static boolean deleteTable(String tablename){
        try (HBaseAdmin admin= (HBaseAdmin)HBaseConn.getHBaseConn().getAdmin()){
            admin.disableTable(tablename);
            admin.deleteTable(tablename);
        }catch (Exception e){
            e.printStackTrace();
        }
        return true;
    }

    /*
     * @description:
     * @date: 2019/07/17
     * @param: [tableName, rowkye, cfName, qualifire, data]
     * è¡¨å å”¯ä¸€æ ‡è¯† åˆ—æ—å åˆ—æ ‡è¯† æ•°æ®
     * @return: boolean
     */
    public static boolean putRow(String tableName,
                                String rowKey,
                                String cfName,
                                String qualifier,
                                String data){
        try (Table table = HBaseConn.getTable(tableName)){

            Put put = new Put(Bytes.toBytes(rowKey));
            put.addColumn(Bytes.toBytes(cfName),
                    Bytes.toBytes(qualifier),
                    Bytes.toBytes(data));

            table.put(put);
        }catch (IOException e){
            e.printStackTrace();
        }

        return true;
    }

    // æ‰¹é‡æ’å…¥
    public static boolean putRows(String tableName, List&lt;Put&gt; rows){

        try (Table table = HBaseConn.getTable(tableName)){

            table.put(rows);
        }catch (IOException e){
            e.printStackTrace();
        }
        return true;
    }

    // è¯»å–ä¸€è¡Œæ•°æ®
    public static Result getRow(String tableName, String rowKey){
        try (Table table = HBaseConn.getTable(tableName)){

            Get get = new Get(Bytes.toBytes(rowKey));
            return table.get(get);

        }catch (IOException e){
            e.printStackTrace();
        }

        return null;
    }


    // é€šè¿‡è¿‡æ»¤å™¨è·å–æ•°æ®
    public static Result getRow(String tableName,
                                String rowKey,
                                FilterList filterList){
        try (Table table = HBaseConn.getTable(tableName)){

            Get get = new Get(Bytes.toBytes(rowKey));

            get.setFilter(filterList);
            return table.get(get);

        }catch (IOException e){
            e.printStackTrace();
        }

        return null;
    }

    // ä½¿ç”¨scanæ‰«æ
    public static ResultScanner getScanner(String tableName){
        try (Table table = HBaseConn.getTable(tableName)){

           Scan scan = new Scan();
           scan.setCaching(1000);
           return table.getScanner(scan);

        }catch (IOException e){
            e.printStackTrace();
        }

        return null;
    }


    // å…¨è¡¨æ‰«æ æŒ‡å®šå¼€å§‹ç»“æŸ rowKey
    // åªåŒ…å«rowkey1 ä¸åŒ…å«rowkey2
    public static ResultScanner getScanner(String tableName,
                                           String startRowKey,
                                           String endRowKey){
        try (Table table = HBaseConn.getTable(tableName)){

            Scan scan = new Scan();

            scan.setStartRow(Bytes.toBytes(startRowKey));

            scan.setStopRow(Bytes.toBytes(endRowKey));

            scan.setCaching(1000);

            return table.getScanner(scan);

        }catch (IOException e){
            e.printStackTrace();
        }

        return null;
    }

    // å…¨è¡¨æ‰«æ æŒ‡å®šå¼€å§‹ç»“æŸ rowKey
    // æŒ‡å®šè¿‡æ»¤å™¨
    public static ResultScanner getScanner(String tableName,
                                           String startRowKey,
                                           String endRowKey,
                                           FilterList filterList){
        try (Table table = HBaseConn.getTable(tableName)){

            Scan scan = new Scan();

            scan.setFilter(filterList);

            scan.setStartRow(Bytes.toBytes(startRowKey));

            scan.setStopRow(Bytes.toBytes(endRowKey));

            scan.setCaching(1000);

            return table.getScanner(scan);

        }catch (IOException e){
            e.printStackTrace();
        }

        return null;
    }

    // åˆ é™¤æŸä¸€è¡Œ
    public static boolean deleteRow(String tableName, String rowKey){

        try (Table table = HBaseConn.getTable(tableName)){

            Delete delete = new Delete(Bytes.toBytes(rowKey));

            table.delete(delete);

        }catch (IOException e){
            e.printStackTrace();
        }

        return true;
    }

    // åˆ é™¤åˆ—æ—
    public static boolean deleteCloumn(String tableName, String cfName){

        try (HBaseAdmin admin= (HBaseAdmin)HBaseConn.getHBaseConn().getAdmin()) {
            admin.deleteColumn(tableName,cfName);
        }catch (Exception e){
            e.printStackTrace();
        }
        return true;
    }

    // åˆ é™¤åˆ—æ—ä¸­çš„qualifier
    public static boolean deleteQulifier(String tableName,
                                         String rowKey,
                                         String cfName,
                                         String qualifierName){
        try (Table table = HBaseConn.getTable(tableName)){

            Delete delete = new Delete(Bytes.toBytes(rowKey));

            delete.addColumn(Bytes.toBytes(cfName),
                    Bytes.toBytes(qualifierName));

            table.delete(delete);

            table.delete(delete);

        }catch (IOException e){
            e.printStackTrace();
        }

        return true;
    }


}

</code></pre></div></div>

<h6 id="æµ‹è¯•">æµ‹è¯•</h6>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.client.ResultScanner;
import org.apache.hadoop.hbase.filter.*;
import org.apache.hadoop.hbase.util.Bytes;
import org.junit.Test;

import java.util.Arrays;

public class HBaseUtilTest {

    @Test
    public void createTable(){
        HBaseUtil.
                createTable("FileTable",new String[]{"fileInfo","saveInfo"});
    }

    @Test
    public void addFileDetails(){
        HBaseUtil.putRow("FileTable","rowkey3",
                "fileInfo","name","file11.txt");
        HBaseUtil.putRow("FileTable","rowkey3",
                "fileInfo","type","txt");
        HBaseUtil.putRow("FileTable","rowkey3",
                "fileInfo","size","1024");
        HBaseUtil.putRow("FileTable","rowkey3",
                "fileInfo","creator","ergou");


        HBaseUtil.putRow("FileTable","rowkey2",
                "fileInfo","name","file22.txt");
        HBaseUtil.putRow("FileTable","rowkey2",
                "fileInfo","type","txt");
        HBaseUtil.putRow("FileTable","rowkey2",
                "fileInfo","size","2048");
        HBaseUtil.putRow("FileTable","rowkey2",
                "fileInfo","creator","dagou");
    }


    @Test
    public void getFileDetail(){
        Result result = HBaseUtil.getRow("FileTable",
                "rowkey2");

        if (result != null){
            System.out.println("rowKey = " + Bytes.toString(result.getRow()));

            System.out.println("fileName = " + Bytes.toString(
                    result.getValue(Bytes.toBytes("fileInfo"),
                            Bytes.toBytes("name"))
            ));
        }
    }

}
</code></pre></div></div>
:ET